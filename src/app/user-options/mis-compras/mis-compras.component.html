<section>
    <app-user-sidebar></app-user-sidebar>
    <div class="container-miscompras">
        <div class="frame">
            <div class="title">
                <h2>Mis Compras</h2>
            </div>
            
            <div class="container">


                <div class="row mb-3">
                    <div class="col-12 col-md-3">
                      <small id="emailHelp" class="form-text text-muted">&nbsp;Palabra clave.</small>
                      <input class="form-control form-control-sm"  placeholder="Search" #input> <!-- (keyup)="applyFilter($event)" -->
                    </div>
                    <div class="col-12 col-md-3">
                      <small id="emailHelp" class="form-text text-muted">&nbsp;Desde</small>
                      <input type="date" class="form-control form-control-sm">
                    </div>
                    <div class="col-12 col-md-3">
                      <small id="emailHelp" class="form-text text-muted">&nbsp;Hasta</small>
                      <input type="date" class="form-control form-control-sm">
                    </div>
                    <div class="col-12 col-md-3">
                      <div class="row">
                        <div class="col-9">
                          <small id="emailHelp" class="form-text text-muted">&nbsp;Estados.</small>
                          <select class="form-control form-control-sm"  #select> <!-- (change)="applyFilter($event)" -->
                            <option value="">Todos</option>
                            <option *ngFor="let estado of estadosOperacion" [value] = "estado">
                              {{estado | convertEstadoOp}}
                            </option>
                          </select>
                        </div>
                        <div class="col-1 mt-4">
                          <button type="button" class="btn btn-primary btn-sm reset"><i class="fas fa-sync"></i></button>
                        </div>
                      </div>
                      
                      
                    </div>
                  </div>


                <div class="table-responsive">
                    <table mat-table matTableResponsive [dataSource]="data" matSort  class="mat-elevation-z8" multiTemplateDataRows>

                        
                        <ng-container  matColumnDef="nroOperacion">
                          <th  mat-header-cell *matHeaderCellDef class="headerTable" mat-sort-header> ID </th>
                          <td mat-cell *matCellDef="let element"> {{element.nroOperacion}} </td>
                        </ng-container>
                      
        
                        <ng-container matColumnDef="direccion.calle">
                            <th mat-header-cell *matHeaderCellDef class="headerTable"> Direccion de envio </th>
                            <td mat-cell *matCellDef="let element"> {{element.direccionEnvio.calle}} {{element.direccionEnvio.numeroCalle}}, Córdoba </td>
                          </ng-container>
                      
                        <ng-container matColumnDef="fechaOperacion">
                          <th mat-header-cell *matHeaderCellDef class="headerTable" mat-sort-header> Fecha de compra</th>
                          <td mat-cell *matCellDef="let element"> {{element.fechaOperacion | convertFecha | slice:0:8}} </td>
                        </ng-container>
        
        
                        <ng-container matColumnDef="fechaEnvio">
                            <th mat-header-cell *matHeaderCellDef class="headerTable" mat-sort-header> Fecha de envío</th>
                            <td mat-cell *matCellDef="let element">Sin datos</td> <!-- {{element.fechaEnviada}} -->
                        </ng-container>
        
                        <ng-container matColumnDef="fechaEntrega">
                            <th mat-header-cell *matHeaderCellDef class="headerTable" mat-sort-header> Fecha de entrega </th>
                            <td mat-cell *matCellDef="let element">Sin datos</td> <!-- {{element.fechaRecibida}} -->
                        </ng-container>
                      
                       
                        <ng-container matColumnDef="estado">
                          <th mat-header-cell *matHeaderCellDef class="headerTable" mat-sort-header> Estado </th>
                          <td mat-cell *matCellDef="let element"> {{element.estado | convertEstadoOp}} </td>
                        </ng-container>
        
                        <ng-container matColumnDef="medioPago.nombre">
                            <th mat-header-cell *matHeaderCellDef class="headerTable" mat-sort-header> Medio de pago </th>
                            <td mat-cell *matCellDef="let element"> {{element.medioPago.nombre | lowercase | titlecase }} </td>
                        </ng-container>
        
                        <ng-container matColumnDef="total">
                            <th mat-header-cell *matHeaderCellDef class="headerTable" mat-sort-header> Total </th>
                            <td mat-cell *matCellDef="let element"> {{element.total | currency:"EUR":"symbol"}} </td>
                        </ng-container>

                         <ng-container matColumnDef="tools">
                            <th mat-header-cell *matHeaderCellDef class="headerTable">  </th>
                            <td mat-cell *matCellDef="let element" (click)="$event.stopPropagation()">
                            
                              <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
                                <mat-icon>more_vert</mat-icon>
                              </button>
                              <mat-menu #menu="matMenu">
                                <button mat-menu-item [routerLink]="['/detalle', element.nroOperacion]">
                                  <mat-icon>visibility</mat-icon>
                                  <span>Ver detalle</span>
                                </button>
                                <button (click)="completarPago(element)" mat-menu-item>
                                  <mat-icon>shopping_bag</mat-icon>
                                  <span>Completar pago</span>
                                </button>
                              </mat-menu>
                            
                            </td>
                        </ng-container>
        
                        <ng-container matColumnDef="expandedDetail">
                            <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplay.length">
                              <div class="example-element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                                
                                <div class="container-fluid jumbotron pt-3 pb-3">
        
                                  <app-detalle-compra-desktop [operacion]="element"></app-detalle-compra-desktop>                                
                                    
                                </div>
                                                            
                              </div>
                            </td>
                            
                        </ng-container>
                        
                        <tr mat-header-row *matHeaderRowDef="columnsToDisplay; sticky: true"></tr>
                        <tr mat-row *matRowDef="let element; columns: columnsToDisplay;"
                            class="example-element-row rowCursor"
                            [class.example-expanded-row]="expandedElement === element"
                            (click)="expandedElement = expandedElement === element ? null : element">
                        </tr>
                        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
                        <!--  -->
        
                      </table>
                </div>
                <mat-paginator style="background-color: transparent;" [pageSizeOptions]="[10, 25, 100]"></mat-paginator>
                
            </div>
            <br>
            

        </div>
        <br>
    </div>


</section>